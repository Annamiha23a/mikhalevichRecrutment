<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaef.org">
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Вакансии</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">
    <link rel="stylesheet" href="css/footer.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
</head>
<body>
<style>
    /*.filter{*/
    /*    height: 65%;*/
    /*    width: 250px;*/
    /*    position: static;*/
    /*    top: 5%;*/
    /*    left: 0;*/
    /*    background-color: #f8f9fa;*/
    /*    padding-top: 20px;*/
    /*    padding-bottom: 200px;*/
    /*}*/
    /*.content {*/
    /*    margin-left: 250px;*/
    /*    padding: 20px;*/
    /*}*/
    .flex {
        display: flex;
        flex-direction: row;
        /*justify-content: space-between;*/
        /*align-items: stretch;*/
        /*height: 200px;*/
        /*border: 5px solid black;*/
    }
    .filter {
        flex: 0 0 300px;
        background-color: #b6efc3;
        padding-top: 40px;
    }
    .content {
        flex: 1 1 25%;
    }
    .int{
        width: 120px;
    }
</style>
<header th:insert="blocks/header :: header"></header>

<div class="flex container mt-5" >
<div class="filter">
    <br><h3>Фильтр</h3><br>
    <form action="/vacancyFilter" method="get">
    <select id="filterSelect"   onchange="applyFilter()"  class="form-select"name="city"  >
        <option value=""> Выберите город</option>
        <option th:each="el : ${vacancyCity}"
                th:value="${el}"
                th:utext="${el}"/>
            </select><br>
    <label for="salery1">ЗП от</label>
    <input class="int" type="number" name="salery1" id="salery1"><br><br>
    <label for="salery2">ЗП до</label>
    <input class="int" type="number" name="salery2" id="salery2"><br><br>
    <label for="resp">Кол-во откликов до</label>
    <input class="int" type="number" name="resp" id="resp"><br>
        <div class="form-row" th:if="${find!=null}">
            <input type="text"  th:value="${find}" name="position" style="opacity: 0" >
        </div>
<br>
        <button class="btn w-100 btn-lg btn-success" type="submit">Фильтрация</button>
    </form>
</div>

<div class="content container">
    <h1>Вакансии</h1>
    <form action="/vacancy" method="get">
            <label for="position">Поиск по позиции</label>
            <input type="text" name="position" id="position"  th:value="${find?:''}" ><br>
        <button class="btn w-25 btn-lg btn-success" type="submit">Поиск</button>
    </form>
    <div style="width: 100%; text-align: center">
        <br>
        <button onclick="location.href='/vacancy/add'" class="btn w-100 btn-lg btn-success">Опубликовать вакансию</button>
        <br>
    </div>
    <table id="filteredVacancies" class="table table-striped mt-3">
        <thead>
        <tr>
            <th>ID</th>
            <th>Позиция</th>
            <th>Описание</th>
            <th>Условия</th>
            <th>Зарплата</th>
            <th>Дополнительно</th>
        </tr>
        </thead>
        <tbody>

        <tr th:each="vac : ${vacancies}">
            <th:block th:if="${#strings.isEmpty(filterValue) or vac.city == filterValue}">
                <td th:text="${vac.id_vacancy}"></td>
                <td th:text="${vac.position}"></td>
                <td th:text="${vac.requirements}"></td>
                <td th:text="${vac.responsibilities}"></td>
                <td th:text="${vac.salary}"></td>
                <td th:utext="@{<a href='/vacancy/}+${vac.getId_vacancy()}+@{'>Подробнее</a>}"></td>
            </th:block>

        </tr>
        </tbody>
    </table>


</div>
</div>
<script>
    function applyFilter() {
        // Получаем выбранное значение из селекта
        var selectedValue = document.getElementById("filterSelect").value;
        console.log(selectedValue);
        // // Устанавливаем значение переменной для фильтрации
        // document.getElementById("filterValue").value = selectedValue;
        //updateFilteredVacancies();
    }
    // Функция для обновления таблицы отфильтрованных вакансий
    function updateFilteredVacancies() {
        // Получаем таблицу и тело таблицы
        var table = document.getElementById("filteredVacancies").getElementsByTagName("tbody")[0];

        // Очищаем текущую таблицу
        table.innerHTML = "";

        document.getElementById("filteredVacancies").innerHTML=" <thead>\n" +
            "        <tr>\n" +
            "            <th>ID</th>\n" +
            "            <th>Позиция</th>\n" +
            "            <th>Описание</th>\n" +
            "            <th>Условия</th>\n" +
            "            <th>Зарплата</th>\n" +
            "            <th>Дополнительно</th>\n" +
            "        </tr>\n" +
            "        </thead>\n" +
            "        <tbody>\n" +
            "\n" +
            "        <tr th:each=\"vac : ${vacancies}\">\n" +
            "            <th:block th:if=\"${vac.city == filterValue}\">\n" +
            "                <td th:text=\"${vac.id_vacancy}\"></td>\n" +
            "                <td th:text=\"${vac.position}\"></td>\n" +
            "                <td th:text=\"${vac.requirements}\"></td>\n" +
            "                <td th:text=\"${vac.responsibilities}\"></td>\n" +
            "                <td th:text=\"${vac.salary}\"></td>\n" +
            "                <td th:utext=\"@{<a href='/vacancy/}+${vac.getId_vacancy()}+@{'>Подробнее</a>}\"></td>\n" +
            "            </th:block>\n" +
            "\n" +
            "        </tr>\n" +
            "        </tbody>";
        // // Фильтруем список вакансий и добавляем отфильтрованные вакансии в таблицу
        // for (var i = 0; i < ${vacancies.length}; i++) {
        //     var vacancy = ${vacancies[i]};
        //     if (!selectedCity || vacancy.city === selectedCity) {
        //         // Создаем строку таблицы для каждой вакансии и добавляем ее в таблицу
        //         var row = table.insertRow();
        //         var titleCell = row.insertCell(0);
        //         var cityCell = row.insertCell(1);
        //         titleCell.textContent = vacancy.title;
        //         cityCell.textContent = vacancy.city;
        //     }
        // }
    }
</script>
<footer th:insert="blocks/footer :: footer"></footer>
</body>

</html>
